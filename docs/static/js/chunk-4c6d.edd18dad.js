(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4c6d"],{10:function(e,t){},11:function(e,t){},"2JI/":function(e,t,n){"use strict";n.r(t);var r=n("14Xm"),a=n.n(r),l=n("D3Ub"),c=n.n(l),o=n("rVWt"),s=n("+n12"),u=n("4d7F"),i=n.n(u),d=n("EUZL"),f=n.n(d);var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"array",n=f.a.read(e,{type:t}),r=n.SheetNames[0],a=n.Sheets[r];return{header:function(e){var t=[],n=f.a.utils.decode_range(e["!ref"]),r=void 0,a=n.s.r;for(r=n.s.c;r<=n.e.c;++r){var l=e[f.a.utils.encode_cell({c:r,r:a})],c="UNKNOWN "+r;l&&l.t&&(c=f.a.utils.format_cell(l)),t.push(c)}return t}(a),results:f.a.utils.sheet_to_json(a)}},m=function(e){return new i.a(function(t,n){var r=new FileReader;e&&r.readAsArrayBuffer(e),r.onload=function(e){var n=e.target.result,r=p(n);t(r)},r.onerror=function(){n()}})},v={name:"excel_import",data:function(){return{list:[]}},methods:{handleTemplate:function(){Object(o.exportExcel)([{k:"id",v:"编号"},{k:"name",v:"姓名"},{k:"age",v:"年龄"},{k:"country",v:"地区"}],[{id:12,name:"刘亦菲",age:24,country:"武汉"}],"导入模板.xlsx")},handleImport:function(){var e=this;return c()(a.a.mark(function t(){var n,r,l;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.a)("excel");case 2:return n=t.sent,t.next=5,m(n);case 5:if(r=t.sent,(l=r.results).length){t.next=9;break}return t.abrupt("return",e.$message.warning("没有数据，请重新导入"));case 9:l.forEach(function(e,t){e.key=t,e.id=e["编号"],e.name=e["姓名"],e.age=e["年龄"],e.country=e["地区"],delete e["姓名"],delete e["编号"],delete e["年龄"],delete e["地区"]}),e.list=l;case 11:case"end":return t.stop()}},t,e)}))()}}},b=(n("wNQV"),n("KHd+")),h=Object(b.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"con-main"},[n("div",{staticClass:"btn-group"},[n("el-button",{staticClass:"mr15",attrs:{type:"primary"},on:{click:e.handleTemplate}},[e._v("模板")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.handleImport}},[e._v("导入")])],1),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list}},[n("el-table-column",{attrs:{prop:"id",label:"编号"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),n("el-table-column",{attrs:{prop:"age",label:"年龄"}}),e._v(" "),n("el-table-column",{attrs:{prop:"country",label:"地区"}})],1)],1)},[],!1,null,"165d6882",null);h.options.__file="import.vue";t.default=h.exports},30:function(e,t){},31:function(e,t){},8:function(e,t){},9:function(e,t){},MmZw:function(e,t,n){},wNQV:function(e,t,n){"use strict";var r=n("MmZw");n.n(r).a}}]);